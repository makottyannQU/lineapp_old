{% extends "layout.html" %}
{% block content %}
<div class="container main" style=" margin-top: 50px;">
    <div class="login-box col-md-12">
        {% if error %}
            <label style="color:#ff0000;">{{ error }}</label>
        {% endif %}
        <form id="login-form" class="form" method="post" enctype=multipart/form-data>
            <div class="form-group">
                <label class="text-info">弁当名</label><br>
                <input type="text" name="name" class="form-control">
            </div>
            <div class="form-group">
                <label class="text-info">小の値段</label><br>
                <input type="text" name="s_price" class="form-control" value="300">
            </div>
            <div class="form-group">
                <label class="text-info">中の値段</label><br>
                <input type="text" name="m_price" class="form-control" value="300">
            </div>
            <div class="form-group">
                <label class="text-info">大の値段</label><br>
                <input type="text" name="l_price" class="form-control" value="400">
            </div>
            <div class="form-group">
                <label for="myImage" class="btn btn-primary">
                    <span>画像を選択</span>
                    <input type="file" name="image" id="myImage" accept="image/png, image/jpeg"
                           style="display: none">
                </label>
            </div>
            <div class="preview"></div>
            <div class="form-group" style="margin-top: 10px">
                <input type="submit" name="submit" class="btn btn-info btn-md" value="登録">
            </div>
        </form>
    </div>
</div>
<script>
    $(function () {
        //画像ファイルプレビュー表示のイベント追加 fileを選択時に発火するイベントを登録
        $('form').on('change', 'input[type="file"]', function (e) {
            var file = e.target.files[0],
                reader = new FileReader(),
                $preview = $(".preview");
            t = this;

            // 画像ファイル以外の場合は何もしない
            if (file.type.indexOf("image") < 0) {
                return false;
            }

            // ファイル読み込みが完了した際のイベント登録
            reader.onload = (function (file) {
                return function (e) {
                    //既存のプレビューを削除
                    $preview.empty();
                    // .prevewの領域の中にロードした画像を表示するimageタグを追加
                    $preview.append($('<img>').attr({
                        src: e.target.result,
                        width: "150px",
                        class: "preview",
                        title: file.name
                    }));
                };
            })(file);

            reader.readAsDataURL(file);
        });
    });
</script>
{% endblock %}